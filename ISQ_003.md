
# Sakura makinesini adÄ±m adÄ±m Ã§Ã¶zme


## TIP-OFF

Ä°lk adÄ±m olarak [Tryhackme sakura](https://www.tryhackme.com/room/sakura) odasÄ±nÄ±n bize vermiÅŸ olduÄŸu

![step1](/gorseller/1.png) 

gÃ¶rselini indirmekle baÅŸlÄ±yoruz. Ä°ndirdikten sonra metadatalarÄ±nÄ± kontrol amaÃ§lÄ± ```exiftool``` aracÄ±ndan yardÄ±m alÄ±yoruz.

![step2](/gorseller/2.jpg)

gÃ¶zlemlendiÄŸi Ã¼zere metadata iÃ§ersinde ```Export-filename``` kÄ±smÄ±nda 1 sorumuzun cevabÄ±nÄ± almaktayÄ±z.


```
question 1: What username does the attacker go by?

answer: SakuraSnowAngelAiko

```


## RECONNAISSANCE

Ufak bir google search ile ```SakuraSnowAngelAiko``` github, linkedIn ve twitter hesaplarÄ±na ulaÅŸmaktayÄ±z.

![step3](/gorseller/3.png)

Github hesabÄ± ile baÅŸlayalÄ±m...

![step4](/gorseller/4.jpg)

Github sayfasÄ±nda  ```PGP```, ```IO``` ve ```ETH``` repolarÄ± ilgimi Ã§ekti ilk bakÄ±ÅŸta. ```PGP``` reposunu iÃ§ine gÃ¶z atÄ±yorum

_KÄ±saca PGP nedir bahsedecek olursak;_

_Pretty Good Privacy (PGP), 1991 yÄ±lÄ±nda Phil Zimmermann tarafÄ±ndan geliÅŸtirilen, OpenPGP standardÄ±nÄ± kullanarak veri ÅŸifrelemek, ÅŸifreli veriyi Ã§Ã¶zmek veya veriyi imzalamak iÃ§in kullanÄ±lan, gÃ¶nderilen ya da alÄ±nan verinin gizliliÄŸini ve kimlik doÄŸrulamasÄ±nÄ± saÄŸlayan bir bilgisayar programÄ±dÄ±r._


![step5](/gorseller/5.png)


```
curl https://github.com/sakurasnowangelaiko/PGP/blob/main/publickey > pgp

```

ile pgp iÃ§ersine ```SakuraSnowAngelAiko``` github reposunu kayÄ±t ediyorum. Daha sonra "John The Ripper" toolunun saÄŸladÄ±ÄŸÄ± gpg ile ÅŸifreyi Ã§Ã¶zmeyi deniyorum.

![step6](/gorseller/6.png)


```
question 2: What is the full email address used by the attacker?

answer: SakuraSnowAngel83@protonmail.com

```


![step7](/gorseller/6_1.png)

```SakuraSnowAngelAiko``` gerÃ§ek ismini sormakta. Twitter hesabÄ±nÄ± zaten bulmuÅŸtuk ilk postunda kendini tanÄ±tmaktadÄ±r. ```@AikoAbe3``` hesabÄ±na gittiÄŸimizde adÄ±nÄ± bulmaktayÄ±z. 

```
question 3: What is the attacker's full real name?

answer: Aiko Abe

```


## UNVEIL

Github hesabÄ±nÄ±n repo kÄ±smÄ±na tekrar dÃ¶necek olursak dikkatimizi Ã§eken  ```PGP```, ```IO``` ve ```ETH``` kÄ±sÄ±mlarÄ±ndan '_ETH_' reposunu incelemek istedim. AslÄ±nda gÃ¶rev anlamÄ±nda takip edecek olursak da o kÄ±smÄ± incelememiz gerektiÄŸi gÃ¶rÃ¼lmektedir.

![step8](/gorseller/7.png)


Bu repo aynÄ± zamanda 4. sorununda cevabÄ±nÄ± vermektedir.
```

question 4: What cryptocurrency does the attacker own a cryptocurrency wallet for?

answer: Ethereum

```


![step9](/gorseller/eth.png)


'_ETH_' reposunda 2 kÄ±sÄ±m var. Biri '_miningscript_' branch'Ä± diÄŸeri ise '_2 commits_' oluÅŸturulduktan sonra 2 kere Ã¼zerinde deÄŸiÅŸiklikler yapÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶zlemledim.


![step10](/gorseller/miningscript.png)

bir adet ethereum kripto para cÃ¼zdan adresi bulumaktadÄ±r. Ama yeterince detay vermemektedir. DeÄŸiÅŸiklik yapÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶zlemlemiÅŸtik bir kontro edelim.

![step11](/gorseller/eth_create.png)

AslÄ±nda bir Ã¶nceki adÄ±mda yani miningscript iÃ§ersinde elde ettiÄŸimiz bilginin burada update edildiÄŸini gÃ¶rmekteyiz. 

![step12](/gorseller/eth_update.png)


Ama ilk Ã¶nce create olarak kripto para cÃ¼zdani adresi oluÅŸturduÄŸu iÃ§in kayÄ±tlÄ± bir ÅŸekilde kalmaktadÄ±r.

![step13](/gorseller/eth_wallet_leak.png)


```

question 5: What is the attacker's cryptocurrency wallet address?

answer: 0xa102397dbeeBeFD8cD2F73A89122fCdB53abB6ef

```

_What mining pool did the attacker receive payments from on January 23, 2021 UTC?_ sorusuyla devam edecek olursak 23 ocak 2021 de mining pool Ã¼zerinden Ã¶deme aldÄ±ÄŸÄ±nÄ± sormaktadÄ±r. AslÄ±nda buraya yazarken farkettim fakat ben izlediÄŸim yoldan gideceÄŸim.(answer: ethermine.org soru 5'in cevabÄ±nÄ± verdiÄŸim screenshot'da gÃ¶rÃ¼lmektedir)

_How to ethereum address_ araÅŸtÄ±rmasÄ± yaptÄ±ÄŸÄ±mda

![step14](/gorseller/9.png)

![step15](/gorseller/ethermine_kesfi.png)

_ethereum explorer_ sitesini keÅŸfediyorum. Bu keÅŸif sonucu soru 5 de cevabÄ±nÄ± bulduÄŸumuz kripto para cÃ¼zden adresini search ediyorum...

soruda 23 ocak 2021 de hangi mining pool Ã¼zerinden Ã¶deme alÄ±ndÄ±ÄŸÄ±nÄ± sormuÅŸtu. 23 ocaÄŸa gelene kadar site de geziniyorum.

![step16](/gorseller/10.png)

23 ocak 2021 de _ethermine_ Ã¼zerinden ethereum aldÄ±ÄŸÄ±nÄ± gÃ¶rmekteyiz.



```

question 6: What mining pool did the attacker receive payments from on January 23, 2021 UTC?

answer: Ethermine

```

AynÄ± kripto para cÃ¼zdanÄ± ile farklÄ± iÅŸlemler yapÄ±lmÄ±ÅŸ mÄ± gÃ¶z atmaya devam edelim...


![step17](/gorseller/11.png)

Tether USD alÄ±mÄ± yapÄ±ldÄ±ÄŸÄ± gÃ¶zlemlenmektedir. 7. sorumuzuda cevaplamÄ±ÅŸ olduk.



```

question 7: What other cryptocurrency did the attacker exchange with using their cryptocurrency wallet?

answer: Tether

```


## TAUNT

_What is the attacker's current Twitter handle?_ sorusundan devam edecek olursak zaten daha Ã¶nceden twitter hesabÄ±nÄ± keÅŸfetmiÅŸtik bizede burda @......... kÄ±smÄ±nÄ± sormaktadÄ±r.

![step18](/gorseller/twitter.png)


```

question 8: What is the attacker's current Twitter handle?

answer: SakuraLoverAiko
```

twitterinda gezerken en aÅŸaÄŸÄ±daki postunda _WiFi_ ve _passwordlerini_ bir yere kayÄ±t ettiÄŸini ve bunlarÄ± ÅŸifrelediÄŸini gÃ¶zlemledim. Bir diÄŸer soruda da kayÄ±t edilen _WiFi_ ve _passwordlerin_ kayÄ±tlÄ± olduÄŸu URL'i istemektedir. Bu soruda biraz fazla oyalandÄ±m ve zorlandÄ±m.  _OsintDojo'ya_ ait github hesabÄ±nÄ±n repolarÄ±nda bu soruya ait bir screenshot olduÄŸunun hintini alarak sorunun cevabÄ±nÄ± aradÄ±m.

![step19](/gorseller/bssid.png)

URL'de bir kÄ±sÄ±ma kadar verildiÄŸini ve diÄŸer kÄ±smÄ±n blurlandÄ±ÄŸÄ±nÄ± gÃ¶rmekteyiz. MD5 ÅŸifreleme tekniÄŸiyle ÅŸifrelenen bir ÅŸey olduÄŸu URL'den belli olmakta. Twitter da daha Ã¶nceden bulduÄŸumuz
_Results for 0a5c6e136a98a60b8a21643ce8c15a74_ ÅŸifreli kÄ±smÄ± belirtilen URL'de _md5=0a5c6e136a98a60b8a21643ce8c15a74_ deÄŸiÅŸtirip 9. sorumuzun cevabÄ±nÄ± alÄ±yoruz.

```

question 8: What is the URL for the location where the attacker saved their WiFi  SSIDs and passwords?

answer: http://depasteon6cqgrykzrgya52xglohg5ovyuyhte3ll7hzix7h5ldfqsyd.onion/show.php?md5=0a5c6e136a98a60b8a21643ce8c15a74

```
_Osintdojo_ github reposundaki gÃ¶rselde incelediÄŸimizde _home wifi_, _city free wifi_ gibi baÅŸlÄ±klara ait bilgilerin olduÄŸu gÃ¶rÃ¼lmektedir.

![step20](/gorseller/bssid_found.jpg)

_What is the BSSID for the attacker's Home WiFi?_ sorusunda da  yukarÄ±da bulduÄŸumuz bilgiler ile bir sonuÃ§ alabileceÄŸimi dÃ¼ÅŸÃ¼nÃ¼yorum. ```Wiglet.net``` sitesinden _advanced search_ kÄ±smÄ±nda _home wifi_ kÄ±smÄ±nÄ± wiglet[.]net . Ã¼zerinden aratÄ±yorum.

![step21](/gorseller/14_1.png)

ÅŸeklinde search ettiÄŸimizce bir adet BSSID keÅŸfediyoruz. Ve doÄŸru cevap...


```

question 9: What is the BSSID for the attacker's Home WiFi?

answer: 84:AF:EC:34:FC:F8

```



## HOMEBOUND


Hikaye'ye baktÄ±ÄŸÄ±mÄ±zda Twitter hesabÄ±ndan ilerlememiz gerektiÄŸinin infosunu vermektedir. Bu kÄ±sÄ±m iÃ§in yani _HOMEBOUND_ baÅŸlÄ±ÄŸÄ± altÄ±ndaki hikayeyi sorulara gÃ¶re ilerledim.

_What airport is closest to the location the attacker shared a photo from prior to getting on their flight?_  UÃ§aÄŸa binmeden Ã¶nceki paylaÅŸÄ±m yaptÄ±ÄŸÄ±nÄ± konuma en yakÄ±n olan  havaalanÄ±nÄ± sormakta. Twitterinda gezinirken _Today, in Bethesda, the beginnings of ğŸŒ¸cherry blossom seasonğŸŒ¸_ bu paylaÅŸÄ±mda _Bethasda'ya_ odaklanÄ±p google search ile birÅŸeyler yakalamaya Ã§alÄ±ÅŸÄ±tÄ±m.

_Bethasda airport_ ÅŸeklinde arama sonucu 5 adet havaalanÄ± verdiÄŸini fakat bizden istenen en yakÄ±n havaalanÄ± yani 9.4 miles uzaklÄ±kta olduÄŸu iÃ§in _Reagan Washington (DCA) Airport_ olacaktÄ±r.

![step22](/gorseller/bethasda.png)

```

question 10: What airport is closest to the location the attacker shared a photo from prior to getting on their flight?

answer: DCA

```

Bir diÄŸer soruda ise son konaklamasÄ±nÄ± hangi havaalanÄ±nda yaptÄ±ÄŸÄ±nÄ± sÃ¶ylemektedir. Twitterda paylaÅŸtÄ±ÄŸÄ± postlardan devam edecek olursak _final layover_ postu aslÄ±nda diÄŸer sorumuzla uyuÅŸmaktadÄ±r. 

![step23](/gorseller/sakura_lounge.png)

_First class lounge_, _Sakura Lounge_, _JAL_ gibi bir kaÃ§ keyword aslÄ±nda fotoÄŸraftan almaktayÄ±z tek tek araÅŸtÄ±rma yaptÄ±ktan sonra _Sakura Lounge_ iÃ§in bir ÅŸeyler buluyorum..
Basit bir google aramasÄ± ile gÃ¶rseller kÄ±smÄ±ndan aynÄ± gÃ¶rsele ait farklÄ± bir aÃ§Ä±dan Ã§ekilmiÅŸ gÃ¶rsel buluyorum.

![step24](/gorseller/sakura_found.png)

GÃ¶rsele ait siteyi ziyaret ettiÄŸimde ise konakladÄ±ÄŸÄ± havaalanÄ±nÄ± keÅŸfediyoruz.

![step25](/gorseller/haneda_airport_found.png)

Soruda bizden istenen havaalanÄ± kodu onun iÃ§inde ufak bir search ile cevabÄ±mÄ±zÄ± almaktayÄ±z.

![step26](/gorseller/hnd.png)



```

question 11: What airport did the attacker have their last layover in?

answer: HND

```


diÄŸer soruyla devam edecek olursak hedef twitter hesabÄ±ndan paylaÅŸÄ±lan bir haritanÄ±n ait olduÄŸu yerde ki gÃ¶lÃ¼n adÄ±nÄ± sormaktadÄ±r. 


![step27](/gorseller/lake_name.png)



AslÄ±nda totalde aldÄ±ÄŸÄ±mÄ±z Ã§oÄŸu bilgilerden yola Ã§Ä±karak Japonya genelinde olduÄŸunu gÃ¶zlemlemekteyiz. Google maps yardÄ±mÄ±yla Japonya'ya geniÅŸ bir aÃ§Ä±dan baktÄ±ÄŸÄ±mÄ±zda hedef twitter hesabÄ±yla aynÄ± aÃ§Ä±yÄ± yakalamaktayÄ±z.

![step28](/gorseller/google_maps.png)


![step29](/gorseller/gg.jpg)

Biraz yakÄ±nlaÅŸtÄ±rÄ±p baktÄ±ÄŸÄ±mÄ±zda bize gÃ¶lÃ¼n ismini vermektedir.


![step30](/gorseller/found_lake_name.png)

```

question 12: What lake can be seen in the map shared by the attacker as they were on their final flight home?

answer: lake inawashiro

```

_What city does the attacker likely consider "home"?_ Geldik son surumuza ev olarak kabul ettiÄŸi muhtemel ÅŸehri sormakta. Bir hayli vaktimi almÄ±ÅŸ olsa da :D sonradan kafaya dank edip _city free wifi_ denedim ve olumlu sonuÃ§ aldÄ±m. 


![step31](/gorseller/city.jpg)



```

question 13: What city does the attacker likely consider "home"?

answer: hirosaki

```